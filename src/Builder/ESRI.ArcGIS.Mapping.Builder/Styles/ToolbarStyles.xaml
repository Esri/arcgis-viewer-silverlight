<!--
(c) Copyright ESRI.
This source is subject to the Microsoft Public License (Ms-PL).
Please see https://opensource.org/licenses/ms-pl for details.
All other rights reserved.
-->

<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:mapping="http://schemas.esri.com/arcgis/mapping/2009"
    xmlns:toolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
    xmlns:inputtoolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Input.Toolkit"
    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
    xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
    xmlns:ee="http://schemas.microsoft.com/expression/2010/effects"
    xmlns:Layout="clr-namespace:ESRI.ArcGIS.Client.Application.Layout;assembly=ESRI.ArcGIS.Client.Application.Layout">
    
    <Color x:Key="HoverOutlineColor">#FF051750</Color>
    <SolidColorBrush x:Key="HoverOutlineStroke" Color="#FF051750"/>
    <LinearGradientBrush x:Key="HoverBackgroundFill" EndPoint="0,23" StartPoint="0,0" MappingMode="Absolute">
        <GradientStop Color="#FF010737" Offset="0.996"/>
        <GradientStop Color="White"/>
        <GradientStop Color="#FF435FA3" Offset="0.119"/>
        <GradientStop Color="#FF0C1D52" Offset="0.463"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="FlashBackgroundFill" EndPoint="0,40" StartPoint="0,0" MappingMode="Absolute">
        <GradientStop Color="#FFFFEB68" Offset="0.996"/>
        <GradientStop Color="White"/>
        <GradientStop Color="#FFFFFFD0" Offset="0.119"/>
        <GradientStop Color="#FFFFFA70" Offset="0.676"/>
        <GradientStop Color="#FFFFFA70" Offset="0.312"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Name="ToolbarGroupBottomBrush" StartPoint="0.5,0" EndPoint="0.5,1">
        <GradientStop Color="#FF0C183D" />
        <GradientStop Color="Black" Offset="1" />
        <GradientStop Color="#FF0C183D" Offset="0.111"/>
        <GradientStop Color="Black" Offset="0.804"/>
        <GradientStop Color="#FF060B1B" Offset="0.341"/>
    </LinearGradientBrush>


    <LinearGradientBrush x:Name="ToolbarBackgroundBrush" StartPoint="0.5,0" EndPoint="0.5,1">
        <GradientStop Color="#FF0D101F" Offset="1" />
        <GradientStop Color="Black" Offset="0.611" />
        <GradientStop Color="#FF050710" Offset="0.037" />
        <GradientStop Color="#FF3B3D45" />
        <GradientStop Color="Black" Offset="0.081"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="ToolbarTabBackgroundBrush" StartPoint="0.5,0" EndPoint="0.5,1">
        <GradientStop Color="#FF323A49" />
        <GradientStop Color="#FF323A49" Offset="0.17" />
        <GradientStop Color="#FF0F1218" Offset="0.384" />
        <GradientStop Color="Black" Offset="1" />
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="BehindTabColorBrush" StartPoint="0.5,0" EndPoint="0.5,1">
        <GradientStop Color="#FFB1B7C6" />
        <GradientStop Color="#FFB1B7C6" Offset="0.17" />
        <GradientStop Color="#FF8A93AB" Offset="0.563" />
        <GradientStop Color="#FF8A93AB" Offset="1" />
    </LinearGradientBrush>
    
    <LinearGradientBrush x:Key="UnselectedTabBrush" StartPoint="0.5,0" EndPoint="0.5,1">
        <GradientStop Color="#FF68728B" />
        <GradientStop Color="#FF68728B" Offset="0.104" />
        <GradientStop Color="#FF4E5766" Offset="0.504" />
        <GradientStop Color="#FF4E5766" Offset="1" />
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="TooltipBackgroundBrush"  StartPoint="0.5,0" EndPoint="0.5,1">
        <GradientStop Color="#FFB1B7C6" />
        <GradientStop Color="White" Offset="1" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="ToolbarActiveTabBrush" Color="#FF323A49"/>

    <Color x:Key="ToolbarForegroundColor">#FFCFD3E7</Color>
    <SolidColorBrush x:Key="ToolbarForegroundBrush" Color="{StaticResource ToolbarForegroundColor}" />

    <Style x:Key="ToolbarButtonStyle" TargetType="mapping:RibbonButton">
        <Setter Property="Background" Value="White"/>
        <Setter Property="Foreground" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Margin" Value="2,4,2,2" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonButton">

                    <Grid>
                        <Grid.Resources>
                            <!-- Storyboard used to highlight button for Getting Started mode -->
                            <Storyboard x:Name="FlashStoryboard" Duration="0:0:2">
                                <DoubleAnimation AutoReverse="True" Duration="0:0:0.5" RepeatBehavior="2"
                                 From="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="FlashAnimation">
                                    <DoubleAnimation.EasingFunction>
                                        <QuarticEase EasingMode="EaseInOut" />
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <ColorAnimation AutoReverse="True" Duration="0:0:0.5" RepeatBehavior="2"
                                 From="{TemplateBinding Foreground}" To="{StaticResource HoverOutlineColor}" 
                                                Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)" 
                                                Storyboard.TargetName="LabelTextElement">
                                    <ColorAnimation.EasingFunction>
                                        <QuarticEase EasingMode="EaseInOut" />
                                    </ColorAnimation.EasingFunction>
                                </ColorAnimation>
                            </Storyboard>
                        </Grid.Resources>
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition From="Normal" GeneratedDuration="0:0:0.3" To="MouseOver">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.2" To="Normal">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" 
                                    			Storyboard.TargetProperty="Opacity" 
                                    			Storyboard.TargetName="BackgroundAnimation"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundAnimation"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BackgroundAnimationOutline2" />

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="LayoutGrid"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid>
                            <Grid Margin="0" x:Name="FlashAnimation" Opacity="0">
                                <Border x:Name="FlashAnimationOutline" CornerRadius="2" 
								RenderTransformOrigin=".5,.5"
								BorderThickness="{TemplateBinding BorderThickness}" 
								BorderBrush="White" Background="{StaticResource FlashBackgroundFill}" >
                                </Border>

                                <Border Margin="1" x:Name="FlashAnimationOutline2" CornerRadius="2"
								BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{StaticResource HoverOutlineStroke}" />
                            </Grid>
                            <Grid Margin="0" x:Name="BackgroundAnimation" Opacity="0"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Grid.RowSpan="2">
                                <Border x:Name="BackgroundAnimationOutline" CornerRadius="2" 
								    RenderTransformOrigin=".5,.5"                                
								    BorderThickness="{TemplateBinding BorderThickness}" 
								    BorderBrush="{StaticResource HoverOutlineStroke}" Background="{StaticResource HoverBackgroundFill}" >
                                </Border>

                                <Border Margin="1" x:Name="BackgroundAnimationOutline2" CornerRadius="2"
								    BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="#FFA2A6C8" />
                            </Grid>

                            <Grid x:Name="LayoutGrid" Width="{TemplateBinding Width}" 
                                      HorizontalAlignment="Center" Margin="{TemplateBinding Padding}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Image Source="{TemplateBinding ImageSource}" Stretch="None" HorizontalAlignment="Center" />
                                <TextBlock x:Name="LabelTextElement" Width="{TemplateBinding LabelTextWidth}" 
                                            HorizontalAlignment="Center" 
                                           Text="{TemplateBinding LabelText}" FontFamily="Calibri" FontSize="11.5" 
                                           Foreground="{TemplateBinding Foreground}" 
                                           TextWrapping="Wrap" TextAlignment="Center" 
                                               Grid.Row="1"/>
                            </Grid>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ToolbarButtonHorizontalStackStyle" TargetType="mapping:RibbonButton">
        <Setter Property="Background" Value="White"/>
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Margin" Value="2,4,2,2" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonButton">

                    <Grid>
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition From="Normal" GeneratedDuration="0:0:0.3" To="MouseOver">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.2" To="Normal">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" 
                                    			Storyboard.TargetProperty="Opacity" 
                                    			Storyboard.TargetName="BackgroundAnimation"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundAnimation"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BackgroundAnimationOutline2" />

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="LayoutGrid"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid>
                            <Grid Margin="0" x:Name="BackgroundAnimation" Opacity="0"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Grid.RowSpan="2">
                                <Border x:Name="BackgroundAnimationOutline" CornerRadius="2" 
								    RenderTransformOrigin=".5,.5"                                
								    BorderThickness="{TemplateBinding BorderThickness}" 
								    BorderBrush="{StaticResource HoverOutlineStroke}" Background="{StaticResource HoverBackgroundFill}" >
                                </Border>

                                <Border Margin="1" x:Name="BackgroundAnimationOutline2" CornerRadius="2"
								    BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="#FFA2A6C8" />
                            </Grid>

                            <Grid x:Name="LayoutGrid" Width="{TemplateBinding Width}" 
                                      HorizontalAlignment="Center" Margin="{TemplateBinding Padding}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{TemplateBinding ImageSource}" Stretch="None" HorizontalAlignment="Center" Margin="5,0,0,0" VerticalAlignment="Center" />
                                    <TextBlock x:Name="LabelTextElement" Width="{TemplateBinding LabelTextWidth}" 
                                            HorizontalAlignment="Center"  VerticalAlignment="Center" Margin="5,0,5,0"
                                           Text="{TemplateBinding LabelText}" FontFamily="Calibri" FontSize="11.5" 
                                           Foreground="{TemplateBinding Foreground}" 
                                           TextWrapping="Wrap" TextAlignment="Center" />
                                </StackPanel>
                            </Grid>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ToolbarDropDownButtonStyle" TargetType="mapping:RibbonDropDownButton">
        <Setter Property="Background" Value="#FF1F3B53"/>
        <Setter Property="Foreground" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="Margin" Value="2,4,2,2" />
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="BorderBrush">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                    <GradientStop Color="#FF718597" Offset="0.375"/>
                    <GradientStop Color="#FF617584" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonDropDownButton">
                    <Grid>
                        <Grid.Resources>
                            <!-- Storyboard used to highlight button for Getting Started mode -->
                            <Storyboard x:Name="FlashStoryboard" Duration="0:0:2">
                                <DoubleAnimation AutoReverse="True" Duration="0:0:0.5" RepeatBehavior="2"
                                 From="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="FlashAnimation">
                                    <DoubleAnimation.EasingFunction>
                                        <QuarticEase EasingMode="EaseInOut" />
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <ColorAnimation AutoReverse="True" Duration="0:0:0.5" RepeatBehavior="2"
                                 From="{TemplateBinding Foreground}" To="{StaticResource HoverOutlineColor}" 
                                                Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)" 
                                                Storyboard.TargetName="LabelTextElement">
                                    <ColorAnimation.EasingFunction>
                                        <QuarticEase EasingMode="EaseInOut" />
                                    </ColorAnimation.EasingFunction>
                                </ColorAnimation>
                                <ColorAnimation AutoReverse="True" Duration="0:0:0.5" RepeatBehavior="2"
                                 From="{TemplateBinding Foreground}" To="{StaticResource HoverOutlineColor}" 
                                                Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)" 
                                                Storyboard.TargetName="ArrowPath">
                                    <ColorAnimation.EasingFunction>
                                        <QuarticEase EasingMode="EaseInOut" />
                                    </ColorAnimation.EasingFunction>
                                </ColorAnimation>
                            </Storyboard>
                        </Grid.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="OpenStates">
                                <VisualState x:Name="PopupClosed"/>
                                <VisualState x:Name="PopupOpen">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" 
											Storyboard.TargetProperty="Opacity" 
											Storyboard.TargetName="BackgroundAnimation2"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition From="Normal" GeneratedDuration="0:0:0.3" To="MouseOver">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.2" To="Normal">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" 
                                    			Storyboard.TargetProperty="Opacity" 
                                    			Storyboard.TargetName="BackgroundAnimation"/>
                                        <ColorAnimation Duration="0" To="#FFA2A6C8" Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)" Storyboard.TargetName="BackgroundAnimationOutline2"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundAnimation"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BackgroundAnimationOutline2" />

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="LayoutGrid"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid>
                        <Grid Margin="0" x:Name="FlashAnimation" Opacity="0">
                            <Border x:Name="FlashAnimationOutline" CornerRadius="2" 
								RenderTransformOrigin=".5,.5"
								BorderThickness="{TemplateBinding BorderThickness}" 
								BorderBrush="White" Background="{StaticResource FlashBackgroundFill}" >
                            </Border>

                            <Border Margin="1" x:Name="FlashAnimationOutline2" CornerRadius="2"
								BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{StaticResource HoverOutlineStroke}" />
                        </Grid>
                        <Grid Margin="0" x:Name="BackgroundAnimation" Opacity="0">
                            <Border x:Name="BackgroundAnimationOutline" CornerRadius="2" 
								RenderTransformOrigin=".5,.5"
								BorderThickness="{TemplateBinding BorderThickness}" 
								BorderBrush="{StaticResource HoverOutlineStroke}" Background="{StaticResource HoverBackgroundFill}" >
                            </Border>

                            <Border Margin="1" x:Name="BackgroundAnimationOutline2" CornerRadius="2"
								BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="White" />
                        </Grid>
                        <Grid Margin="0" x:Name="BackgroundAnimation2" Opacity="0">
                            <Border CornerRadius="2" 
								RenderTransformOrigin=".5,.5"
								BorderThickness="{TemplateBinding BorderThickness}" 
								BorderBrush="{StaticResource HoverOutlineStroke}" Background="{StaticResource HoverBackgroundFill}" >
                            </Border>

                            <Border Margin="1" CornerRadius="2"
								BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="#FFA2A6C8" />
                        </Grid>

                            <Grid x:Name="LayoutGrid" Width="{TemplateBinding Width}" HorizontalAlignment="Center" 
                                  Margin="{TemplateBinding Padding}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Image Source="{TemplateBinding ImageSource}" Stretch="None" HorizontalAlignment="Center" />
                                <Grid x:Name="SplitElementContainerGrid" Grid.Row="1" Width="{TemplateBinding Width}" HorizontalAlignment="Center">
                                    <TextBlock x:Name="LabelTextElement" HorizontalAlignment="Center" 
                                               Text="{TemplateBinding LabelText}" FontFamily="Calibri" 
                                               FontSize="11.5" Foreground="{TemplateBinding Foreground}" 
                                       TextWrapping="Wrap" TextAlignment="Center" Width="{TemplateBinding Width}" />
                                    <ContentControl x:Name="ArrowElement" HorizontalAlignment="Center" 
                                                    HorizontalContentAlignment="Center" Height="8">
                                        <Path x:Name="ArrowPath" Data="M 0,0 L 8,0 L 4,4 Z" Margin="2" Fill="{TemplateBinding Foreground}" 
                                              VerticalAlignment="Center" HorizontalAlignment="Center" />
                                    </ContentControl>
                                </Grid>
                            </Grid>
                        </Grid>

                        <Rectangle x:Name="FocusVisualElement" RadiusX="2" RadiusY="2" Margin="1" Stroke="#FF6DBDD1" StrokeThickness="1" Opacity="0" IsHitTestVisible="false"/>

                        <Popup x:Name="Popup">
                            <Border x:Name="PopupBorder" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="3" HorizontalAlignment="Stretch" Height="Auto"
                                    Background="{StaticResource DesignHostBackgroundBrush}">
                                <ContentPresenter Content="{TemplateBinding PopupContent}"/>
                            </Border>
                        </Popup>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="TopButtonStripStyle" TargetType="mapping:RibbonButton">
        <Setter Property="Background" Value="White"/>
        <Setter Property="Foreground" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Margin" Value="2,4,2,2" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonButton">

                    <Grid>
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition From="Normal" GeneratedDuration="0:0:0.3" To="MouseOver">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.2" To="Normal">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" 
        										Storyboard.TargetProperty="Opacity" 
        										Storyboard.TargetName="BackgroundAnimation"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundAnimation"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="PressedBackground"/>

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="LayoutGrid"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid>
                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Margin="0"/>
                            <Grid Margin="0" x:Name="BackgroundAnimation" Opacity="0"
        							VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
        							Grid.RowSpan="2">
                                <Border x:Name="BackgroundAnimationOutline" 
        								RenderTransformOrigin=".5,.5" Background="{StaticResource HoverBackgroundFill}" Margin="0" BorderThickness="1,0,0,1" />
                                <Border x:Name="PressedBackground" 
        								RenderTransformOrigin=".5,.5" Margin="1,0,0,1" BorderThickness="1,0,0,1" Opacity="0" Background="{StaticResource HoverOutlineStroke}" >
                                    <Border.RenderTransform>
                                        <CompositeTransform Rotation="180"/>
                                    </Border.RenderTransform>
                                </Border>
                            </Grid>

                            <Grid x:Name="LayoutGrid" Width="{TemplateBinding Width}" 
        							HorizontalAlignment="Center" Margin="{TemplateBinding Padding}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Image Source="{TemplateBinding ImageSource}" Stretch="None" HorizontalAlignment="Center" />
                                <TextBlock x:Name="LabelTextElement" Width="{TemplateBinding LabelTextWidth}" 
        								HorizontalAlignment="Center" 
        								Text="{TemplateBinding LabelText}" FontFamily="Calibri" FontSize="11.5" 
        								Foreground="{TemplateBinding Foreground}" 
        								TextWrapping="Wrap" TextAlignment="Center" 
        								Grid.Row="1"/>
                            </Grid>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="BottomButtonStripStyle" TargetType="mapping:RibbonButton">
        <Setter Property="Background" Value="White"/>
        <Setter Property="Foreground" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="Padding" Value="4"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Margin" Value="2,4,2,2" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonButton">

                    <Grid>
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition From="Normal" GeneratedDuration="0:0:0.3" To="MouseOver">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.2" To="Normal">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" 
        										Storyboard.TargetProperty="Opacity" 
        										Storyboard.TargetName="BackgroundAnimation"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundAnimation"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="PressedBackground"/>

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="LayoutGrid"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid>
                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Margin="0"/>
                            <Grid Margin="0" x:Name="BackgroundAnimation" Opacity="0"
        							VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
        							Grid.RowSpan="2">
                                <Border x:Name="BackgroundAnimationOutline" 
        								RenderTransformOrigin=".5,.5" Background="{StaticResource HoverBackgroundFill}" Margin="1,0,0,0" BorderThickness="1,0,0,1" >
                                    <Border.RenderTransform>
                                        <CompositeTransform Rotation="180"/>
                                    </Border.RenderTransform>
                                </Border>
                                <Border x:Name="PressedBackground" 
        								RenderTransformOrigin=".5,.5" Margin="1,0,0,0" BorderThickness="1,0,0,1" Opacity="0" Background="{StaticResource HoverOutlineStroke}" >
                                    <Border.RenderTransform>
                                        <CompositeTransform Rotation="180"/>
                                    </Border.RenderTransform>
                                </Border>
                            </Grid>

                            <Grid x:Name="LayoutGrid" Width="{TemplateBinding Width}" 
        							HorizontalAlignment="Center" Margin="{TemplateBinding Padding}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Image Source="{TemplateBinding ImageSource}" Stretch="None" HorizontalAlignment="Center" />
                                <TextBlock x:Name="LabelTextElement" Width="{TemplateBinding LabelTextWidth}" 
        								HorizontalAlignment="Center" 
        								Text="{TemplateBinding LabelText}" FontFamily="Calibri" FontSize="11.5" 
        								Foreground="{TemplateBinding Foreground}" 
        								TextWrapping="Wrap" TextAlignment="Center" 
        								Grid.Row="1"/>
                            </Grid>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style x:Key="BottomSplitButtonStripStyle" TargetType="mapping:SplitButton">
        <Setter Property="Background" Value="White"/>
        <Setter Property="Foreground" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Margin" Value="2,4,2,2" />
        <Setter Property="Width" Value="Auto" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:SplitButton">

                    <Grid>
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition From="Normal" GeneratedDuration="0:0:0.3" To="MouseOver">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.2" To="Normal">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" 
        										Storyboard.TargetProperty="Opacity" 
        										Storyboard.TargetName="BackgroundAnimation"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundAnimation"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="PressedBackground"/>

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="LayoutGrid"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid>
                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Margin="0"/>
                            <Grid Margin="0" x:Name="BackgroundAnimation" Opacity="0"
        							VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
        							Grid.RowSpan="2">
                                <Border x:Name="BackgroundAnimationOutline" 
        								RenderTransformOrigin=".5,.5" Background="{StaticResource HoverBackgroundFill}" Margin="1,0,0,0" BorderThickness="1,0,0,1" >
                                    <Border.RenderTransform>
                                        <CompositeTransform Rotation="180"/>
                                    </Border.RenderTransform>
                                </Border>
                                <Border x:Name="PressedBackground" 
        								RenderTransformOrigin=".5,.5" Margin="1,0,0,0" BorderThickness="1,0,0,1" Opacity="0" Background="{StaticResource HoverOutlineStroke}" >
                                    <Border.RenderTransform>
                                        <CompositeTransform Rotation="180"/>
                                    </Border.RenderTransform>
                                </Border>
                            </Grid>

                            <Grid x:Name="LayoutGrid" Width="{TemplateBinding Width}" Margin="4" HorizontalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="16"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter x:Name="contentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}"/>
                                <Rectangle Grid.Column="1" Width="1" Fill="{TemplateBinding Foreground}" Opacity="0.4" Margin="4"/>
                                <Grid x:Name="SplitElement" Grid.Column="2" Background="Transparent">
                                    <inputtoolkit:ContextMenuService.ContextMenu>
                                        <inputtoolkit:ContextMenu ItemsSource="{Binding ButtonMenuItemsSource, RelativeSource={RelativeSource TemplatedParent}}" Foreground="{TemplateBinding Foreground}" FlowDirection="{TemplateBinding FlowDirection}"/>
                                    </inputtoolkit:ContextMenuService.ContextMenu>
                                    <Path Data="M 0,0 L 8,0 L 4,4 Z" Fill="{TemplateBinding Foreground}" VerticalAlignment="Center"
                                          HorizontalAlignment="Center"/>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style x:Key="GroupStyle" TargetType="mapping:RibbonGroupControl">
        <Setter Property="Foreground" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        <Setter Property="Margin" Value="2,3,2,2" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonGroupControl">
                    <Border Margin="{TemplateBinding Margin}">
                        <Border BorderThickness="1" CornerRadius="2" BorderBrush="#FF7F8186">

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="20"/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="1" />
                                </Grid.ColumnDefinitions>

                                <!--Content-->
                                <Border Background="{StaticResource ToolbarBackgroundBrush}" Grid.Row="1">
                                    <ContentPresenter
							    Cursor="{TemplateBinding Cursor}" 
							    ContentTemplate="{TemplateBinding ContentTemplate}" 
							    Content="{TemplateBinding Content}" 
							    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
							    Margin="{TemplateBinding Padding}" 
							    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                </Border>

                                <!--Header-->
                                <Border Background="{StaticResource ToolbarGroupBottomBrush}">
                                    <TextBlock  Cursor="{TemplateBinding Cursor}" 
                                        Text="{TemplateBinding Header}"
                                        FontFamily="Calibri" FontSize="12" Foreground="{TemplateBinding Foreground}" 										                                              
										HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
										Margin="{TemplateBinding Padding}" VerticalAlignment="Center"/>
                                </Border>


                            </Grid>
                        </Border>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="TabStyle" TargetType="mapping:RibbonTabControl">
        <Setter Property="Foreground" Value="White" />
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="Background" Value="#FF1F3B53"/>
        <Setter Property="BorderBrush" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="15,5"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        <Setter Property="MinWidth" Value="5"/>
        <Setter Property="MinHeight" Value="5"/>
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonTabControl">
                    <Grid x:Name="Root" Margin="0,2,0,0">
                        <Grid.Resources>
                            <ControlTemplate x:Name="ContentTemplateStyle" TargetType="ContentControl">
                                <Grid >
                                    <Border Background="{StaticResource ToolbarTabBackgroundBrush}">
                                        <Grid >
                                            <Border HorizontalAlignment="Right" Width="300" 
                                                Background="{StaticResource UnselectedTabBrush}"
                                                VerticalAlignment="Stretch">
                                                <Border.OpacityMask>
                                                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                                        <GradientStop Color="Transparent" Offset="0"/>
                                                        <GradientStop Color="Black" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.OpacityMask>
                                            </Border>
                                            <ContentPresenter Content="{TemplateBinding Content}"                                           
                                                   Cursor="{TemplateBinding Cursor}"                                           
                                                  />
                                        </Grid>
                                    </Border>
                                </Grid>
                            </ControlTemplate>
                        </Grid.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0"/>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.25" To="Normal"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="Disabled" />
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.508" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow"/>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="0.91"/>
                                            <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="0.877">
                                                <EasingDoubleKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingDoubleKeyFrame.EasingFunction>
                                            </EasingDoubleKeyFrame>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                                            <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="0.77">
                                                <EasingDoubleKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingDoubleKeyFrame.EasingFunction>
                                            </EasingDoubleKeyFrame>
                                        </DoubleAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#000000A1"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#3E0000A1">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#3A02026E"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#6002026E">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <DoubleAnimation Duration="0" To="0.197" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[5].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow"/>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[5].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#001313C4"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#2A1313C4">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimation Duration="0" To="#6402026E" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow"/>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[6].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#0002026E"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#5402026E">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected"/>
                                <VisualState x:Name="Selected"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid x:Name="TemplateTopSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <Border Background="{StaticResource ToolbarActiveTabBrush}" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="1,2,1,0" Margin="0">
                                <ContentControl x:Name="HeaderTopSelected" Cursor="{TemplateBinding Cursor}"                                                     
                                		Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" 
                                		HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" 
                                		Margin="{TemplateBinding Padding}" 
                                		VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                            </Border>
                            <Border x:Name="FocusVisualTop" BorderBrush="#FF6DBDD1" BorderThickness="1,1,1,0" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-2,-2,-2,0" Visibility="Collapsed"/>
                            <Border x:Name="DisabledVisualTopSelected" Background="#8CFFFFFF" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-2,-2,-2,0" Opacity="0"/>
                        </Grid>
                        <Grid x:Name="TemplateTopUnselected" Visibility="Collapsed">
                            <Border x:Name="TemplateTopUnselectedBorder" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1,2,1,0" Margin="0" Background="{StaticResource UnselectedTabBrush}"/>
                            <Border x:Name="MouseOverGlow" BorderThickness="0"  
                                	CornerRadius="3,3,0,0" Margin="0" Opacity="0">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                                        <GradientStop Color="#000000FF" Offset="1"/>
                                        <GradientStop Color="Blue" Offset="1"/>
                                        <GradientStop Color="#590000A1" Offset="0.205"/>
                                        <GradientStop Color="#5902026E" Offset="0.791"/>
                                        <GradientStop Color="#000000FF"/>
                                        <GradientStop Color="#1E1313C4" Offset="0.152"/>
                                        <GradientStop Color="#1F010185" Offset="0.725"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            <Border x:Name="MarginBorder" BorderThickness="1,2,1,0"  
                                	CornerRadius="5,0,0,0" Margin="0">
                                <ContentControl x:Name="HeaderTopUnselected"                                             
                                		Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" 
                                		FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" 
                                		IsTabStop="False" VerticalAlignment="{TemplateBinding VerticalAlignment}" Margin="{TemplateBinding Padding}"/>
                            </Border>
                        </Grid>
                        <Grid x:Name="TemplateBottomSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderBottomSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateBottomUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderBottomUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateLeftSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderLeftSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateLeftUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderLeftUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateRightSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderRightSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateRightUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderRightUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Border x:Name="FocusVisualElement" BorderBrush="#FF6DBDD1" BorderThickness="1" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-1" Visibility="Collapsed"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="LeftTabStyle" TargetType="mapping:RibbonTabControl">
        <Setter Property="Foreground" Value="White" />
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="Background" Value="#FF1F3B53"/>
        <Setter Property="BorderBrush" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="17,5,15,5"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        <Setter Property="MinWidth" Value="5"/>
        <Setter Property="MinHeight" Value="5"/>
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonTabControl">
                    <Grid x:Name="Root" Margin="0,2,0,0">
                        <Grid.Resources>
                            <ControlTemplate x:Name="ContentTemplateStyle" TargetType="ContentControl">
                                <Grid >
                                    <Border Background="{StaticResource ToolbarTabBackgroundBrush}">
                                        <Grid >
                                            <Border HorizontalAlignment="Right" Width="300" 
                                                Background="{StaticResource UnselectedTabBrush}"
                                                VerticalAlignment="Stretch">
                                                <Border.OpacityMask>
                                                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                                        <GradientStop Color="Transparent" Offset="0"/>
                                                        <GradientStop Color="Black" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.OpacityMask>
                                            </Border>
                                            <ContentPresenter Content="{TemplateBinding Content}"                                           
                                                   Cursor="{TemplateBinding Cursor}"                                           
                                                  />
                                        </Grid>
                                    </Border>
                                </Grid>
                            </ControlTemplate>
                        </Grid.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0"/>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.25" To="Normal">
                                        <VisualTransition.GeneratedEasingFunction>
                                            <CubicEase EasingMode="EaseOut"/>
                                        </VisualTransition.GeneratedEasingFunction>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="Disabled" />
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.508" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow"/>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="0.91"/>
                                            <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="0.877">
                                                <EasingDoubleKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingDoubleKeyFrame.EasingFunction>
                                            </EasingDoubleKeyFrame>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                                            <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="0.77">
                                                <EasingDoubleKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingDoubleKeyFrame.EasingFunction>
                                            </EasingDoubleKeyFrame>
                                        </DoubleAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#000000A1"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#3E0000A1">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#3A02026E"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#6002026E">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <DoubleAnimation Duration="0" To="0.197" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[5].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow"/>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[5].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#001313C4"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#2A1313C4">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimation Duration="0" To="#6402026E" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow"/>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[6].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#0002026E"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#5402026E">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected"/>
                                <VisualState x:Name="Selected"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <VisualStateManager.CustomVisualStateManager>
                            <ei:ExtendedVisualStateManager/>
                        </VisualStateManager.CustomVisualStateManager>
                        <Grid x:Name="TemplateTopSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <Border Background="{StaticResource ToolbarActiveTabBrush}" 
        							BorderBrush="{TemplateBinding BorderBrush}" 
        							BorderThickness="2,2,1,0"  
        							CornerRadius="5,0,0,0" Margin="0">
                                <ContentControl x:Name="HeaderTopSelected" Cursor="{TemplateBinding Cursor}"                                                     
        								Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" 
        								HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" 
        								Margin="{TemplateBinding Padding}" 
        								VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                            </Border>
                            <Border x:Name="FocusVisualTop" BorderBrush="#FF6DBDD1" BorderThickness="1,1,1,0" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-2,-2,-2,0" Visibility="Collapsed"/>
                            <Border x:Name="DisabledVisualTopSelected" Background="#8CFFFFFF" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-2,-2,-2,0" Opacity="0"/>
                        </Grid>
                        <Grid x:Name="TemplateTopUnselected" Visibility="Collapsed">
                            <Border x:Name="TemplateTopUnselectedBorder" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2,2,1,0"  
        							CornerRadius="5,0,0,0" Margin="0" Background="{StaticResource UnselectedTabBrush}"/>
                            <Border x:Name="MouseOverGlow" BorderThickness="0"  
        							CornerRadius="3,3,0,0" Margin="0" Opacity="0">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                                        <GradientStop Color="#000000FF" Offset="1"/>
                                        <GradientStop Color="Blue" Offset="1"/>
                                        <GradientStop Color="#590000A1" Offset="0.205"/>
                                        <GradientStop Color="#5902026E" Offset="0.791"/>
                                        <GradientStop Color="#000000FF"/>
                                        <GradientStop Color="#1E1313C4" Offset="0.152"/>
                                        <GradientStop Color="#1F010185" Offset="0.725"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            <Border x:Name="MarginBorder" BorderThickness="2,2,1,0"  
        							CornerRadius="5,0,0,0" Margin="0">
                                <ContentControl x:Name="HeaderTopUnselected"                                             
        								Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" 
        								FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" 
        								IsTabStop="False" VerticalAlignment="{TemplateBinding VerticalAlignment}" Margin="{TemplateBinding Padding}"/>
                            </Border>
                        </Grid>
                        <Grid x:Name="TemplateBottomSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderBottomSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateBottomUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderBottomUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateLeftSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderLeftSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateLeftUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderLeftUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateRightSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderRightSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateRightUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderRightUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Border x:Name="FocusVisualElement" BorderBrush="#FF6DBDD1" BorderThickness="1" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-1" Visibility="Collapsed"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RightTabStyle" TargetType="mapping:RibbonTabControl">
        <Setter Property="Foreground" Value="White" />
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="Background" Value="#FF1F3B53"/>
        <Setter Property="BorderBrush" Value="{StaticResource ToolbarForegroundColor}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="15,5,17,5"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        <Setter Property="MinWidth" Value="5"/>
        <Setter Property="MinHeight" Value="5"/>
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mapping:RibbonTabControl">
                    <Grid x:Name="Root" Margin="0,2,0,0">
                        <Grid.Resources>
                            <ControlTemplate x:Name="ContentTemplateStyle" TargetType="ContentControl">
                                <Grid >
                                    <Border Background="{StaticResource ToolbarTabBackgroundBrush}">
                                        <Grid >
                                            <Border HorizontalAlignment="Right" Width="300" 
                                                Background="{StaticResource UnselectedTabBrush}"
                                                VerticalAlignment="Stretch">
                                                <Border.OpacityMask>
                                                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                                        <GradientStop Color="Transparent" Offset="0"/>
                                                        <GradientStop Color="Black" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.OpacityMask>
                                            </Border>
                                            <ContentPresenter Content="{TemplateBinding Content}"                                           
                                                   Cursor="{TemplateBinding Cursor}"                                           
                                                  />
                                        </Grid>
                                    </Border>
                                </Grid>
                            </ControlTemplate>
                        </Grid.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0"/>
                                    <VisualTransition From="MouseOver" GeneratedDuration="0:0:0.25" To="Normal"/>
                                </VisualStateGroup.Transitions>
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="Disabled" />
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.508" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow"/>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="0.91"/>
                                            <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="0.877">
                                                <EasingDoubleKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingDoubleKeyFrame.EasingFunction>
                                            </EasingDoubleKeyFrame>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                                            <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="0.77">
                                                <EasingDoubleKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingDoubleKeyFrame.EasingFunction>
                                            </EasingDoubleKeyFrame>
                                        </DoubleAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#000000A1"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#3E0000A1">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#3A02026E"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#6002026E">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <DoubleAnimation Duration="0" To="0.197" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[5].(GradientStop.Offset)" Storyboard.TargetName="MouseOverGlow"/>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[5].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#001313C4"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#2A1313C4">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimation Duration="0" To="#6402026E" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow"/>
                                        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[6].(GradientStop.Color)" Storyboard.TargetName="MouseOverGlow">
                                            <EasingColorKeyFrame KeyTime="0" Value="#0002026E"/>
                                            <EasingColorKeyFrame KeyTime="0:0:0.25" Value="#5402026E">
                                                <EasingColorKeyFrame.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </EasingColorKeyFrame.EasingFunction>
                                            </EasingColorKeyFrame>
                                        </ColorAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected"/>
                                <VisualState x:Name="Selected"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid x:Name="TemplateTopSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <Border Background="{StaticResource ToolbarActiveTabBrush}" 
        							BorderBrush="{TemplateBinding BorderBrush}" 
        							BorderThickness="1,2,2,0"  
        							CornerRadius="0,5,0,0" Margin="0">
                                <ContentControl x:Name="HeaderTopSelected" Cursor="{TemplateBinding Cursor}"                                                     
        								Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" 
        								HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" 
        								Margin="{TemplateBinding Padding}" 
        								VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                            </Border>
                            <Border x:Name="FocusVisualTop" BorderBrush="#FF6DBDD1" BorderThickness="1,1,1,0" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-2,-2,-2,0" Visibility="Collapsed"/>
                            <Border x:Name="DisabledVisualTopSelected" Background="#8CFFFFFF" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-2,-2,-2,0" Opacity="0"/>
                        </Grid>
                        <Grid x:Name="TemplateTopUnselected" Visibility="Collapsed">
                            <Border x:Name="TemplateTopUnselectedBorder" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1,2,2,0"  
        							CornerRadius="0,5,0,0" Margin="0" Background="{StaticResource UnselectedTabBrush}"/>
                            <Border x:Name="MouseOverGlow" BorderThickness="0"  
        							CornerRadius="3,3,0,0" Margin="0" Opacity="0">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                                        <GradientStop Color="#000000FF" Offset="1"/>
                                        <GradientStop Color="Blue" Offset="1"/>
                                        <GradientStop Color="#590000A1" Offset="0.205"/>
                                        <GradientStop Color="#5902026E" Offset="0.791"/>
                                        <GradientStop Color="#000000FF"/>
                                        <GradientStop Color="#1E1313C4" Offset="0.152"/>
                                        <GradientStop Color="#1F010185" Offset="0.725"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            <Border x:Name="MarginBorder" BorderThickness="1,2,2,0"  
        							CornerRadius="5,0,0,0" Margin="0">
                                <ContentControl x:Name="HeaderTopUnselected"                                             
        								Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" 
        								FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" 
        								IsTabStop="False" VerticalAlignment="{TemplateBinding VerticalAlignment}" Margin="{TemplateBinding Padding}"/>
                            </Border>
                        </Grid>
                        <Grid x:Name="TemplateBottomSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderBottomSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateBottomUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderBottomUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateLeftSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderLeftSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateLeftUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderLeftUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateRightSelected" Visibility="Collapsed" Canvas.ZIndex="1">
                            <ContentControl x:Name="HeaderRightSelected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Grid x:Name="TemplateRightUnselected" Visibility="Collapsed">
                            <ContentControl x:Name="HeaderRightUnselected" Cursor="{TemplateBinding Cursor}" Foreground="{TemplateBinding Foreground}" FontSize="{TemplateBinding FontSize}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" IsTabStop="False" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalAlignment}"/>
                        </Grid>
                        <Border x:Name="FocusVisualElement" BorderBrush="#FF6DBDD1" BorderThickness="1" CornerRadius="3,3,0,0" IsHitTestVisible="false" Margin="-1" Visibility="Collapsed"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>

